<!doctype html>
<html lang="pt">
<head>
  <meta charset="utf-8">
  <title>step-quote-app Â· Estimador CNC</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Drag-and-drop STEP âžœ confirmar parÃ¢metros âžœ tempos (peÃ§a piloto/sÃ©rie) e orÃ§amento. UI industrial. Local.">
  <link rel="stylesheet" href="./css/styles.css">
</head>
<body>
<header class="topbar">
  <div class="brand">
    <div class="logo" aria-hidden="true">â—‡</div>
    <div class="title">
      <strong>step-quote-app</strong>
      <span class="muted">local Â· offline-first</span>
    </div>
  </div>
  <div class="actions">
    <button id="resetBtn" class="btn ghost" title="Limpar sessÃ£o">Reset</button>
  </div>
</header>

<main class="container">
  <!-- Etapas -->
  <ol class="steps">
    <li class="step" data-step="1"><span>1</span> Upload STEP</li>
    <li class="step" data-step="2"><span>2</span> ParÃ¢metros</li>
    <li class="step" data-step="3"><span>3</span> Resultados</li>
  </ol>

  <!-- Painel 1: Upload -->
  <section id="panelUpload" class="panel">
    <header class="panel__header">
      <h2>Upload do ficheiro STEP</h2>
      <p class="muted">Arraste um ficheiro <b>.step</b> / <b>.stp</b> ou clique para selecionar.</p>
    </header>

    <div id="dropzone" class="dropzone" tabindex="0" role="button" aria-label="Carregar STEP">
      <input id="fileInput" type="file" accept=".step,.stp" hidden>
      <div class="dz__icon" aria-hidden="true">â¬†</div>
      <div class="dz__text">Arraste o ficheiro aqui<br><small>ou clique para selecionar</small></div>
    </div>

    <div id="fileInfo" class="fileinfo hidden">
      <div class="fileinfo__row"><span>Nome</span><b id="fiName">â€”</b></div>
      <div class="fileinfo__row"><span>Tamanho</span><b id="fiSize">â€”</b></div>
      <div class="fileinfo__row"><span>Ãšltima modificaÃ§Ã£o</span><b id="fiDate">â€”</b></div>
    </div>

    <footer class="panel__footer">
      <button id="toParamsBtn" class="btn primary" disabled>Continuar para ParÃ¢metros</button>
    </footer>
  </section>

  <!-- Painel 2: ParÃ¢metros -->
  <section id="panelParams" class="panel hidden">
    <header class="panel__header">
      <h2>ParÃ¢metros de ProduÃ§Ã£o</h2>
      <p class="muted">Confirme/tune os parÃ¢metros. Guardamos no dispositivo (localStorage).</p>
    </header>

    <form id="paramsForm" class="grid two">
      <!-- Material -->
      <fieldset>
        <legend>Material</legend>
        <label>Tipo
          <select id="materialKey"></select>
        </label>
        <div class="grid two">
          <label>Densidade (g/cmÂ³)
            <input id="density" type="number" step="0.01" min="0">
          </label>
          <label>Custo (â‚¬ / kg)
            <input id="costPerKg" type="number" step="0.01" min="0">
          </label>
        </div>
        <div class="grid two">
          <label>MRR Rough (cmÂ³/min)
            <input id="mrrRough" type="number" step="1" min="0">
          </label>
          <label>MRR Finish (cmÂ³/min)
            <input id="mrrFinish" type="number" step="1" min="0">
          </label>
        </div>
      </fieldset>

      <!-- MÃ¡quina -->
      <fieldset>
        <legend>MÃ¡quina</legend>
        <label>Tipo
          <select id="machineKey"></select>
        </label>
        <div class="grid two">
          <label>Taxa (â‚¬ / h)
            <input id="hourlyRate" type="number" step="1" min="0">
          </label>
          <label>Setup (min)
            <input id="setupMin" type="number" step="1" min="0">
          </label>
        </div>
      </fieldset>

      <!-- Globais -->
      <fieldset>
        <legend>Globais</legend>
        <div class="grid three">
          <label>Stock factor
            <input id="stockFactor" type="number" step="0.01" min="1" value="1.05">
          </label>
          <label>Seg/Face (acab.)
            <input id="secPerFace" type="number" step="0.1" min="0" value="0.8">
          </label>
          <label>Seg/Furo
            <input id="secPerHole" type="number" step="0.1" min="0" value="3">
          </label>
        </div>
        <div class="grid three">
          <label>Desgaste (â‚¬ / cmÂ³)
            <input id="wearPerCm3" type="number" step="0.001" min="0" value="0.002">
          </label>
          <label>Overhead (Ã—)
            <input id="overheadMult" type="number" step="0.01" min="1" value="1.12">
          </label>
          <label>Margem (Ã—)
            <input id="marginMult" type="number" step="0.01" min="1" value="1.18">
          </label>
        </div>
        <div class="grid two">
          <label>Unidades (geom.)
            <select id="units">
              <option value="millimeter">mm</option>
              <option value="inch">inch</option>
              <option value="centimeter">cm</option>
              <option value="meter">m</option>
              <option value="foot">ft</option>
            </select>
          </label>
          <label>Moeda
            <select id="currency">
              <option value="EUR">EUR</option>
              <option value="USD">USD</option>
              <option value="GBP">GBP</option>
            </select>
          </label>
        </div>
      </fieldset>

      <!-- Lotes -->
      <fieldset>
        <legend>Lotes (peÃ§as/sÃ©rie)</legend>
        <div class="grid four">
          <label>Q1
            <input id="q1" type="number" step="1" min="1" value="1">
          </label>
          <label>Q10
            <input id="q10" type="number" step="1" min="1" value="10">
          </label>
          <label>Q50
            <input id="q50" type="number" step="1" min="1" value="50">
          </label>
          <label>Q100
            <input id="q100" type="number" step="1" min="1" value="100">
          </label>
        </div>
      </fieldset>
    </form>

    <footer class="panel__footer">
      <button id="backToUploadBtn" class="btn ghost">Voltar</button>
      <button id="toResultsBtn" class="btn primary">Calcular</button>
    </footer>
  </section>

  <!-- Painel 3: Resultados -->
  <section id="panelResults" class="panel hidden">
    <header class="panel__header">
      <h2>Resultados (Piloto & SÃ©rie)</h2>
      <p class="muted">Nesta fase: placeholder de cÃ¡lculo. IntegraÃ§Ã£o STEP/OCCT entra na prÃ³xima etapa.</p>
    </header>

        <!-- ðŸ‘‡ Painel de DiagnÃ³stico -->
    <section class="diag">
      <div class="diagGrid">
        <div class="metricCard">
          <h4>BBox (mm)</h4>
          <div id="mBBox" class="metricValue">â€”</div>
        </div>
        <div class="metricCard">
          <h4>Volume peÃ§a (cmÂ³)</h4>
          <div id="mVolume" class="metricValue">â€”</div>
        </div>
        <div class="metricCard">
          <h4>RemoÃ§Ã£o (cmÂ³)</h4>
          <div id="mRemoval" class="metricValue">â€”</div>
        </div>
        <div class="metricCard">
          <h4>Faces</h4>
          <div id="mFaces" class="metricValue">â€”</div>
        </div>
        <div class="metricCard">
          <h4>CÃ­rculos</h4>
          <div id="mCircles" class="metricValue">â€”</div>
        </div>
      </div>

      <div class="sliders">
        <div class="sliderRow">
          <label for="sliderFace">Seg/Face (acabamento)</label>
          <input id="sliderFace" type="range" min="0" max="5" step="0.1">
          <span id="sliderFaceVal" class="sliderVal">0.0s</span>
        </div>
        <div class="sliderRow">
          <label for="sliderHole">Seg/Furo</label>
          <input id="sliderHole" type="range" min="0" max="10" step="0.1">
          <span id="sliderHoleVal" class="sliderVal">0.0s</span>
        </div>
      </div>
    </section>


    <div class="results">
      <div class="resultCard">
        <h3>PeÃ§a Piloto</h3>
        <div class="kv"><span>Tempo total</span><b id="rPilotTime">â€”</b></div>
        <div class="kv"><span>Custo estimado</span><b id="rPilotCost">â€”</b></div>
      </div>
      <div class="resultCard">
        <h3>SÃ©rie</h3>
        <div id="batchList" class="batchList"></div>
      </div>
    </div>

    <footer class="panel__footer">
      <button id="backToParamsBtn" class="btn ghost">Ajustar ParÃ¢metros</button>
      <button id="exportBtn" class="btn">Exportar JSON</button>
    </footer>
  </section>


</main>

<!-- Toast -->
<div id="toast" class="toast hidden" role="status" aria-live="polite"></div>

<script src="./js/config.js"></script>
<script src="./js/app.js"></script>
</body>
</html>
